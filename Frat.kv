#:kivy 2.0.0
#:import utils kivy.utils

WindowManager:
    FratForLife:
        name: "main"
    AnalysisReportApp:
        name: "second"

<FratForLife>:
    name: "main"

    csv_txt_input: csv_txt_input

    canvas.before:

        Color:
            rgb: utils.get_color_from_hex('#0f6875')

        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: 'vertical'
        size: root.width, root.height
        spacing: 50
        padding: 50

        Label:
            id: title
            color: .7, .7, .7, .7
            font_size: 70  
            center_x: root.width / 2
            top: root.top - 50
            text: "Feedback Response Analysis Tool"

        BoxLayout:
            orientation: 'horizontal'
            size: root.width, root.height
            
            topic_text: topic_text
            TextInput:
                id: topic_text
                halign: 'center'
                valign: 'middle'
                center_y: root.width / 2
                disabled: True
                text: 'Welcome to the Feedback Response Analysis Tool. \nThis tool takes either a csv file or your plain text in and performs thematic, semantic, and sentiment analysis on it. \nBy default, you can click the "Browse local files" button to choose a csv file to analyze. \nClick the "Toggle Input Method" button to enable plaintext input and type in the bottom text field. \nYou will see your results after clicking the "Analyze" button.'

        ToggleButton:
            id: toggle_btn
            size_hint: 0.1, 0.5
            center_y: root.width / 2
            text: 'Toggle Input Method'
            width: 50
            on_release: root.toggle_disable_inputs()
        
        BoxLayout:
            orientation: 'horizontal'
            size: root.width, root.height/4
            spacing: 10

            TextInput:
                id: csv_txt_input
                size_hint: 1, 0.5
                center_y: root.width / 2
                top: root.top - 50
                text: 'CSV file location'

            Button:
                id: browse_btn
                size_hint: 1, 0.5
                center_y: root.width / 2
                top: root.top - 50
                text: 'Browse local files'
                on_release: root.show_load()

        BoxLayout:
            orientation: 'horizontal'
            size: root.width, root.height/4

            TextInput:
                id: typed_txt_input
                center_y: root.width / 2
                disabled: True
                text: 'Enable toggle to type in a single response.'

        BoxLayout:
            orientation: 'horizontal'
            size: root.width, root.height/4

            Label:
                id: title
                color: .5, .5, .5, .5
                font_size: 70  
                center_x: root.width / 2
                top: root.top - 50
                text: " "

            Button:
                id: analyze_btn
                size_hint: 0.25, 0.5
                center_y: root.width / 2
                top: root.top - 50
                text: 'Analyze'
                on_release: 
                    root.main()
                    app.root.current = "second"
                    root.manager.transition.direction = "left"
                    root.topic()

<AnalysisReportApp>:
    name: "second"

    canvas.before:

        Color:
            rgb: utils.get_color_from_hex('#0f6875')

        Rectangle:
            pos: self.pos
            size: self.size

    # LAYOUT #
    BoxLayout:
        orientation: 'vertical'

        # TITLE #
        # Label:
        #     id: title
        #     color: .7, .7, .7, .7
        #     font_size: 20  
        #     center_x: root.width / 2
        #     top: root.top - 50
        #     text: "Feedback Response Analysis Report"
        Label:
            text: 'Feedback Response Analysis Report'
            size_hint_y: None
            height: 64
            padding: (8, 8)
            color: .7, .7, .7, .7
            font_size: 45 
            center_x: root.width / 2

        # CONTENT #
        BoxLayout:
            orientation: 'horizontal'

            # GRID #
            GridLayout:
                cols: 2

                # SUMMARY #
                BoxLayout:
                    orientation: 'vertical'
                    Label:
                        text: 'summary'
                    Label:
                        text: 'content'
                        size_hint_y: None
                        height: 32
                # CHART #
                BoxLayout:
                    orientation: 'vertical'
                    BoxLayout:
                        orientation: 'vertical'
                        id: sentiment_chart
                # TOPICS1 #
                BoxLayout:
                    orientation: 'vertical'
                    Label:
                        text: 'Topic'
                    BoxLayout:
                        id: topic_one

                # TOPICS2 #
                BoxLayout:
                    orientation: 'vertical'
                    BoxLayout:
                        orientation: 'vertical'
                        id: top_token_bar_chart

            # SIDEBAR #
            BoxLayout:
                orientation: 'vertical'
                size_hint_x: None
                width: 200

                Button:
                    text: 'New Analysis'
                    size_hint_y: None
                    height: 50
                    on_release: 
                        root.clearTopics()
                        app.root.current = "main"
                        root.manager.transition.direction = "right"

<LoadDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        FileChooserListView:
            id: filechooser

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()
            Button:
                text: "Load"
                on_release: root.load(filechooser.path, filechooser.selection)
